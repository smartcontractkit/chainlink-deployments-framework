{{- define "proposal" -}}

{{- /* Title: show domain and environment when provided */ -}}
{{- if or .Request.Domain .Request.EnvironmentName -}}
## Proposal — {{ .Request.Domain }}{{ if .Request.EnvironmentName }} ({{ .Request.EnvironmentName }}){{ end }}

{{ end -}}

{{- /* Batch operations: one collapsible <details> per batch */ -}}
{{- $batches := .Proposal.BatchOperations -}}
{{- if $batches -}}
{{- range $i, $batch := $batches }}
<details>
{{ $chainName := resolveChainSelector .ChainSelector -}}
<summary><h3>Batch {{ add $i 1 }} — {{ if $chainName }}{{ $chainName }} (<code>{{ .ChainSelector }}</code>){{ else }}Chain <code>{{ .ChainSelector }}</code>{{ end }}</h3></summary>

{{ template "batchOperation" $batch }}
</details>
{{ end -}}
{{- else -}}
_No batch operations._
{{ end -}}

{{- end -}}
