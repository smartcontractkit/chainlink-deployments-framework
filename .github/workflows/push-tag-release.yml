name: push-tag-release

on:
  push:
    tags:
      - v*

jobs:
  cicd-publish-release:
    runs-on: ubuntu-latest
    permissions:
      id-token: write
      contents: write
      actions: read
    steps:
      - name: cicd-publish-release
        uses: smartcontractkit/.github/actions/cicd-build-publish-artifacts-go@3f8c6dca3135ebe8f7956031819dd6a6c7aeb5a9 # cicd-build-publish-artifacts-go@0.4.0
        with:
          # general inputs
          app-name: chainlink-deployments-framework
          publish: "false" # do not publish docker image to ECR
          update-git-tag: "true"
          # goreleaser inputs
          goreleaser-args: "--config .goreleaser.yml"
          goreleaser-version: '~> v2'
          goreleaser-dist: goreleaser-pro
          goreleaser-key: ${{ secrets.GORELEASER_KEY }}
